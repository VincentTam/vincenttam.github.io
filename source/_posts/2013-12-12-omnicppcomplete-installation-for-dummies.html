---
layout: post
title: OmniCppComplete Installation for Dummies
date: 2013-12-12 01:01:00 +08:00
categories:
- Vim
- C/C++
tags:
- clang_complete
- OmniCppComplete
published: true
comments: true
---
<p><em>Note: In Stack Overflow question 12339415, it is suggested that clang is better. For its installation, refer to its another fan's <a href="http://aknow-work.blogspot.hk/2013/04/vim-clangcomplete.html">blog</a>.</em></p>

<!-- more -->

<p>Background: OmniCppComplete is a great Vim plugin that has the popup menu like many big IDEs. <a href="http://youtu.be/MQy2rVOf-z0">A Youtube video</a> can show the power of OmniCppComplete.<br />Download: OmniCppComplete requires ctags.</p>

<ol>
    <li>OmniCppComplete: <a href="https://github.com/FromtonRouge/OmniCppComplete">GitHub Repository</a> (To avoid mixing up of files from different plugins, use one plugin management plugin like Pathogen or Vundle.)</li>
    <li>Ctags: <a href="http://ctags.sourceforge.net/">Official homepage</a> on SourceForge (The ZIP file for Win* 2**0 is fine.)</li>
</ol>

<p>For more detailed information on the installation of ctags, please refer to my earlier blog post <a href="http://blogue-un.blogspot.hk/2013/12/links-to-good-posts.html"><em>Links to Good Posts</em></a>.</p>

<p>Problem: Reading the OmniCppComplete's documentation only, you won't be able to understand how to use this plugin, so follow some tutorials, and the most viewed one should be on <a href="http://vim.wikia.com/wiki/C%2B%2B_code_completion">Vim Tips Wiki</a>. Followed its guidance, I got error in typing <code>std::</code> in a new .cpp file. Omni completion told me something like "pattern not  match". I spent nearly 2 hours to figure out what's wrong, and finally  managed to fully understand the contents of <a href="http://carl830.pixnet.net/blog/post/67681043-vim-omnicppcomplete%2Bstl-support">this blog entry</a>.<br />Now, I'm going to make <u>a Win* version of Vim Tips Wiki's tutorial</u>, using the ideas from Carl.</p>

<p>Solution:</p>

<ol>
    <li>
    I suppose OmniCppComplete and ctags are installed properly.
    <ul>
	<li>
	<p>OmniCppComplete does not mix up with other plugins.</p>

	<p>Note: For gVimPortable, do store files under the Data folder, but NOT the <code>$VIMRUNTIME</code> file. Otherwise the settings will be lost after upgrading gVimPortable.</p>

	{% img /images/posts/OmniCpp/pathogen.png 'fig1' 'Vim plugins location using pathogen.vim' %}

	<p><small>The folder for different plugins are separated (except the plugin management plugin itself).</small></p>
	</li>

	<li>
	Typing <code>:h omnicppcomplete</code> in Vim normal mode gives up the help file for OmniCppComplete.

	{% img /images/posts/OmniCpp/omnicpp.png 'fig2' 'Help for OmniCppComplete.txt' %}

	<p><small>Typing <code>:h omnicppcomplete</code> gives you the corresponding help file.</small></p>
	</li>

	<li>
	<p>The folder for ctags is in the PATH environment variable.</p>

	<p>Follow <a href="http://geekswithblogs.net/renso/archive/2009/10/21/how-to-set-the-windows-path-in-windows-7.aspx">this page</a> for setting the PATH variable.</p>

	{% img fancybox /images/posts/OmniCpp/ctags.png 'Set PATH variable' 'fig1' %}

	<p><small><code>C:\ctags58</code> should be in the <code>PATH</code> variable.</small></p>
	</li>
    </ul>
    </li>

    <li>
    Download the <a href="http://www.vim.org/scripts/script.php?script_id=2358">modified libstdc++ headers</a> from <a href="https://github.com/vim-scripts/tags-for-std-cpp-STL-streams-...">GitHub</a>.
    </li>

    <li>
    Unzip the folder and place it under "somewhere meaningful to you"<br />
    My suggestion: <code>C:\Users\[your-user-name]\.vim</code><br />
    Here you can substitute <code>[your user name]</code> with your <u>real</u> user name on Win*.<br />
    Note: In the dialogue (in case you use GUI), DON'T input <code>tags</code> at the end. Otherwise, you'll get <code>C:\Users\[your-user-name]\.vim<b><span class="err">\tags</span></b>\tags</code>
    </li>

    <li>
    <p>If things go right, you should have <code>C:\Users\[your-user-name]\.vim\tags</code></p>

    <p>Go to that directory by typing <code>cd .vim\tags</code> in Win*'s Command Prompt, which can be involked by typing <code>cmd</code> in the "Start" menu. (For Win* XP, choose "Run" and type "cmd" in the popup dialogue. If you like choosing from the menu, follow <a href="http://windows.microsoft.com/en-hk/windows-vista/open-a-command-prompt-window">the way on the official website</a>.)</p>

    <p>At first, a commad prompt should be like this.</p>

    {% img /images/posts/OmniCpp/cmd.png 'fig4' 'Command Prompt default starting display' %}

    <p><small>The current directory is <code>C:\Users\<span class="HLCode">Owner</span></code>.</small></p>

    {% img /images/posts/OmniCpp/cmd2.png 'fig5' 'Change directory in Win* CMD' %}

    <p><small>Change the current directory to <code>C:\Users\<span class="HLCode">Owner</span>\.vim\tags</code>.</small></p>

    <p>The contents should be shown by typing <code>dir</code> (There're so many files that I use the <code>/w</code> option to save space.)</p>

    {% img /images/posts/OmniCpp/dir1.png 'fig6' 'w flag in dir command in Win* CMD' %}

    <p><small>The contents are in the right place, so we may proceed.</small></p>

    {% img /images/posts/OmniCpp/ctags1.png 'fig7' 'Ctags in Win* CMD' %}

    <p><small>Get a list of ctags.</small></p>

    <p>To get a list of ctags, the correct command:</p>

    <pre class="cli"><code>&gt;ctags -R --sort=1 --c++-kinds=+p --fields=+iaS --extra=+q --language-force=C++ -f cpp <span class="HLCode">.</span></code></pre>

    <p>The one you see on Vim Tips Wiki:</p>

    <pre class="cli"><code>&gt;ctags -R --sort=1 --c++-kinds=+p --fields=+iaS --extra=+q --language-force=C++ -f cpp <span class="err">cpp_src</span></code></pre>
    </li>

    <li>Then you should have a huge list of ctags with the file name cpp. Not adding the additional tags for OpenGL, etc, is OK.</li>

    <li>
    <p>Finally, adding the lines found in the Vim Tips Wiki into your vimrc will do.</p>

    <p>Note: If you don't add the additional tags in step 5, then the following lines should NOT be added.</p>

{% codeblock lang:vim %}
set tags+=~/.vim/tags/gl
set tags+=~/.vim/tags/sdl
set tags+=~/.vim/tags/qt4
{% endcodeblock %}

    </li>
</ol>

<h3>Testing</h3>

<p>A picture can illustrate the feature well. Typing <code>std::</code>, you'll get a popup list.</p>

    {% img /images/posts/OmniCpp/omni.png 'fig8' 'OmniCppComplete in GVim' %}

<h3>Incompatibility with clang_complete</h3>

<p>Note that Omnicppcomplete is <em>incompatible</em> with another Vim plugin called clang_complete, due to its "unconditional popup of completion list". To understand this, the following pictures give a good interpretation.</p>

<p>In OmniCppComplete, after typing <code>std::</code>, the completion list will pop up.</p>

<p>However, in clang_complete, since the information is from the clang compiler, you need to give the syntax in the right position for the compiler so as to let the completion list to show up.</p>

{% img /images/posts/OmniCpp/ClangComplete1.png 'fig9' 'missing iostream' %}

<p><small>Missing <code>#include &lt;iostream&gt;</code>.</small></p>


{% img /images/posts/OmniCpp/std_err.png 'fig10' 'wrong place for std::' %}

<p><small>Still wrong position of the input</small></p>

{% img /images/posts/OmniCpp/ClangComplete2.png 'fig11' 'clang_complete work for correct code' %}

<p><small>Right position</small></p>

<p>On Ubuntu, it's easy to install. Note that you need <code>clang-dev</code> as well. For Win*, maybe you need to download the source. (I hope there will be a <em>compiled version of the compiler</em>.)</p>
