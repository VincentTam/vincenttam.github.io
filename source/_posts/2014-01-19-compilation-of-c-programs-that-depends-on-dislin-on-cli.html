---
layout: post
title: Compilation of C++ Programs that Depends on DISLIN on CLI
categories:
- C/C++
tags:
- C/C++
- DISLIN
- programming
published: true
comments: true
---
<p>As a supporter of <a href="http://www.gnu.org/" target="_blank">the GNU Project</a>, I am not so happy to use <a href="http://www.dislin.de/" target="_blank">DISLIN</a>, which comes with an <em>EULA</em>, but I don't have time to find out another alternative to the plotting library suggested by Prof. Yevick in his book <a href="http://www.cambridge.org/ec/academic/subjects/physics/computational-science-and-modelling/short-course-computational-science-and-engineering-c-java-and-octave-numerical-programming-free-software-tools" target="_blank"><em>A Short Course in Computational Science and Engineering: C++, Java and Octave Numerical Programming with Free Software Tools</em></a>.</p>

<p><a href="http://linux4research.blogspot.hk/2007/05/install-and-use-dislin-under-linuxe.html" target="_blank">A DISLIN installation guide on Ubuntu</a> found on the blog <a href="http://linux4research.blogspot.hk"><em>Linux for Research</em></a> was written more than six years ago, so I am a bit dubious that if steps 2 and 3 are still needed for the installation using a DEB file. Therefore, I overlooked an important command and I regret this after wasting about two hours on <a href="http://www.google.com" target="_blank">Google</a>.</p>

<p>As a result, I just downloaded the DEB file from the DISLIN official website and use the GUI tool "Ubuntu Software Centre" to install the library. Then I directly copied the code from the book and tried to compile the program (I named it <code>first_graphics_prog.cpp</code>.).</p>

<p>[code language="cpp" highlight="13"]<br />
// Author: David Yevick<br />
// Source: A Short Course in Computational Science and Engineering<br />
#include &lt;iostream&gt;<br />
#include &lt;dislin.h&gt;</p>

<p>using namespace std;</p>

<p>int main(int argc, const char *argv[])<br />
{
    // Some code for defining variables<br />
    // Omitted to avoid copyright problems<br />
    // An example of using DISLIN methods<br />
    qplot(array1,array2,numOfPts);<br />
}
[/code]</p>

<p>However, the compiler gave me the message that I had used an "undefined reference to qplot".</p>

<p>I googled for two hours and found nothing that I can understand. I even tried compiling the following sample code found in section 2.7 of <a href="http://www2.mps.mpg.de/dislin/contents.html" target="_blank">the official DISLIN online manual</a>.</p>

<p>[code language="cpp"]<br />
// Author: Helmut Michels<br />
// Source: DISLIN 10.4—A Data Plotting Library<br />
#include &lt;iostream&gt;<br />
#include &quot;discpp.h&quot;</p>

<p>main()<br />
{ Dislin g;<br />
  g.disini ();<br />
  g.messag (&quot;This is a test&quot;, 100, 100);<br />
  g.disfin ();<br />
}
[/code]</p>

<p>I have <em>no</em> hope on published books because their authors would expect their students to do something easy—Use <a href="http://www.bloodshed.net/devcpp.html" target="_blank">Dev-C++</a> on M$ Win*, or *nix GUI IDE like <a href="http://www.eclipse.org">Eclipse</a>. However, some geeks <em>won't</em> be satisfied because GUI buttons/objects hide the commands away from users. As a result, they <em>don't</em> know what tasks are invoked by clicking the button/object. In other words, they <em>don't</em> know what they are <em>actually</em> doing. Therefore, they have the motivation to find out the <em>real</em> command for the compilation of C++ programs that <code>#include "dislin.h"</code>.</p>

<p><a href="http://stackoverflow.com" target="_blank">Stack Overflow</a> has <em>a few or no</em> questions on the compilation of C++ programs that use DISLIN. The most relevant one that I managed to find is <a href="http://stackoverflow.com/questions/19118465/compiling-dislin-gfortran">question 19118465</a>. It's titled <em>Compiling dislin gfortran</em>. I glanced at the answers quickly. They have some commands like</p>

<p>[code language="bash" gutter="false"]<br />
gfortran EX11_1.f90 -o progrname -ldislin -I/path/to/DISLIN/modules<br />
[/code]</p>

<p>Then I guessed that I need the <code>-ldislin</code> flag as well. I <em>can't</em> truly figure out the usage of <code>-l</code>, <code>-L</code> and <code>-I</code> flags by just looking at the man page of <code>g++</code>, so I just tried everything. I searched for some new pages, and returned to some web pages that I've <em>already visited</em>, and continued this <em>unproductive</em> process...</p>

<p>I googled the websites and I saw the post on Linux for Research mentioned before. I looked at the command that begins with <code>g++</code> and tried to adapt it to my needs, but it simply <em>failed</em>.</p>

<p>I thought that the official README maybe useful, so I browsed the contents in <code>/usr/local/dislin/README</code>. Some websites that teach users to install DISLIN from a gzip tarball contain code that manipulate the environment variables like <code>DISLIN</code>, <code>PATH</code> and <code>LD_LIBRARY_PATH</code>. But in the <code>README</code>, it's clearly stated that I don't need to do so.</p>

<p>[code highlight="11,12" gutter="false"]<br />
f) To make DISLIN available for general use, write the following com-<br />
mands to your .profile or to /etc/profile</p>

<p>DISLIN=directory                     <br />
export DISLIN<br />
PATH=${PATH}:${DISLIN}/bin</p>

<p>LD_LIBRARY_PATH=$DISLIN:$LD_LIBRARY_PATH<br />
export LD_LIBRARY_PATH</p>

<p>Note: The environment variable DISLIN is not necessary if DISLIN<br />
is installed in the default directory '/usr/local/dislin'.<br />
[/code]</p>

<p>I think that I <em>don't</em> need to do the above settings, but I am <em>not</em> sure about that. Luckily, the following part that immediately follows the above section gave me some hint on what I, as a newcomer to DISLIN, can do.</p>

<p>[code highlight="7" gutter="false"]<br />
4.) Compiling, Linking and Running the Example Programs</p>

<p>   Now you can compile, link and run the example programs in the<br />
   directory $DISLIN/examples with the commands:</p>

<p>                    clink     -a exa_c      (for gcc)<br />
                    cpplink   -a exa_cpp    (for g++)<br />
                    iclink    -a exa_c      (for Intel icc)<br />
                    sclink    -a exa_c      (Sun Studio cc)<br />
...<br />
[/code]</p>

<p>Thus, I <em>really</em> went to <code>/usr/local/dislin/example</code> and compiled <code>exa_cpp.cpp</code> using <code>cpplink</code> with the <code>-a</code> flag. <em>It works! No complaints from <code>g++</code>!</em> It seemed that I could give <code>cpplink</code> a try, but it quickly turned out that my idea failed to work. <code>g++</code> either complained that <code>dislin.h</code> was <em>not</em> found, or there's "undefined reference" to a DISLIN function.</p>

<p>After that, I returned to Google again, and was redirected to the <em>same</em> post on Linux for Research again. I glanced through the <em>same</em> command that started with <code>g++</code>.</p>

<p>[code language="bash" gutter="false"]<br />
g++ test.cpp -lXt -ldislin -lm<br />
[/code]</p>

<p>This time, I could read the sentence below the above command.</p>

<p><blockquote>
    Don't forget the <code>-lXt</code>
</blockquote></p>

<p>I finally realised that I had forgotten an important principle in programming: <em>Don't</em> do too much at one time. At the very first stage, I need to get things done, though the approach is <em>not</em> elegant.</p>

<p>With the above principle in my mind, I could merely compile a C++ program that made use of DISLIN by making the following changes in both the source file and the command that I issued.</p>

<p>[code language="cpp" highlight="4"]<br />
// Author: David Yevick<br />
// Source: A Short Course in Computational Science and Engineering<br />
#include &lt;iostream&gt;<br />
#include &quot;/usr/local/dislin/dislin.h&quot;</p>

<p>using namespace std;</p>

<p>int main(int argc, const char *argv[])<br />
{
    // Some code for defining variables<br />
    // Omitted to avoid copyright problems<br />
    // An example of using DISLIN methods<br />
    qplot(array1,array2,numOfPts);<br />
}
[/code]</p>

<p>In the terminal, I typed the following command.</p>

<p>[code language="bash" gutter="false"]<br />
g++ foo.cpp -lXt -ldislin -lm<br />
[/code]</p>

<p><em>It works!</em> Critical readers will complain about the way that I include <code>dislin.h</code>. I'm not satisfied with this either. Another obvious missing part for those who want to customise the name of the output executable file is the <code>-o</code> flag. I <em>delibrately</em> did this so as to keep things <em>simple and clear</em>.</p>

<p>After trying the <code>-l</code>, <code>-L</code> and <code>-I</code> flags of the command <code>g++</code>, I realised that the <code>-I</code> flag will do.</p>

<p>However, when I tried to do the <em>same</em> task for another time, it surprisingly <em>failed</em>. Looking closely at the two versions, we can draw the following conclusion.</p>

<p>[code language="bash" gutter="false"]<br />
# `DISLIN' is a variable that represents the path of DISLIN.<br />
# In the default case, it is `/usr/local/dislin'.<br />
g++ -lXt -ldislin -lm -I$(DISLIN) foo.cpp -o foo.out # Wrong!<br />
g++ foo.cpp -o foo.out -lXt -ldislin -lm -I$(DISLIN) # Correct!<br />
[/code]
<br />
<img src="http://blogueun.files.wordpress.com/2014/01/dislin_compile-140119.png" alt="message_from_g++" /></p>

<p>I conclude this post with the fact that the flags <code>-g -Wall</code> can be put either before or after <code>foo.cpp</code>.</p>

<p>Posted via <a href="http://0x3f.org/blog/ultrablog-as-an-ultimate-vim-blogging-plugin/" target="_blank">UltraBlog.vim</a>.</p>
